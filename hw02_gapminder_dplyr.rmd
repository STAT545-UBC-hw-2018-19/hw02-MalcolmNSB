---
title: "Exploring gapminder using dplyr and ggplot2"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this document, we will be exploring the `gapminder` dataset using (among other tools) the `dplyr` and `ggplot2` functions. First we load the gapminder dataset and dplyr using the tidyverse package.
```{r}
library(gapminder)
library(tidyverse)
```
##Smell test the data
In this section we determine some basic attributes of `gapminder`.

 * Is it a data.frame, a matrix, a vector, a list?
```{r}

is.data.frame(gapminder)
is.matrix(gapminder)
is.vector(gapminder)
is.list(gapminder)
```
 We see that `gapminder` is a data.frame and a list, but it is not a matrix or a vector.
 
 * What is its class?
```{r}
class(gapminder)
```
 We see that `gapminder` is a data.frame, a tibble (`tbl`), and a tibble dataframe (`tbl_df`).
 
 * How many variables/columns?
```{r}
ncol(gapminder)
```
 
 
 * How many rows/observations?
 
```{r}
nrow(gapminder)
```
 
 * Can you get these facts about “extent” or “size” in more than one way? Can you imagine different functions being useful in different contexts?
 
We can determine both the class and the number of rows & columns (among other information) of `gapminder` another way by using, for example, the `str` function,
```{r}
str(gapminder)
```
 which also displays the class(es) of gapminder and the number of rows & columns.
 
 * What data type is each variable?
 
 From above, we read off that *continent* and *country* are of `factor` type, *year* and *population* are `integer`, and *life expectancy* and *Gdp per capita* are `numerical`.
 


 
## Exploring a variable
We shall pick, continent as a categorical variable and population as a quantitative one.


* What are possible values (or range, whichever is appropriate) of each variable?
```{r}
distinct(select(gapminder, continent))
range(select(gapminder, pop))
range(select(gapminder, lifeExp))
```

* What values are typical? What’s the spread? What’s the distribution? Etc., tailored to the variable at hand.

We can use the summary function to give basic statistical information about the population and life expectancy
```{r}
gapminder %>% 
  select(pop, lifeExp) %>% 
  summary()
```
## Plots

Let's explore population visually, using log-scale.
```{r}
ggplot(gapminder, aes(pop)) +
  scale_x_log10() +
  geom_histogram(aes(y=..density..), fill = "green") +
  geom_density()
```

Scatter plot of population with life expectancy across the five continents:
```{r}
ggplot(gapminder, aes(lifeExp,pop))+
  geom_point(aes(colour=continent), alpha = 0.2) +
  scale_y_log10() +
  facet_wrap(~ continent)
```
We see that in all continents and all countries in those continents, there appears to be a linear relation between population and life expectancy.

Here is a violin plot overlayed with a jitter plot for life expectancy across continents:

```{r}
gapminder %>% 
  select(continent, lifeExp) %>% 
  ggplot(aes(continent, lifeExp)) +
  geom_violin() +
  geom_jitter(aes(colour = continent), alpha = 0.3)
  
```

In the following, we create a (log) plot of population across multiple years in Austraila, New Zealand, and Canada.
```{r}
gapminder %>% 
  filter(continent == "Oceania" | country == "Canada") %>% 
  select(country, year,  pop) %>% 
  ggplot(aes(year, pop, shape = country)) +
  scale_y_log10() +
  geom_point() +
  geom_smooth(method ="lm")
```
Here we see from a linear regression fit that the populations of Australia and Canada across the sampled years were increasing at about the same rate, while the population growth in New Zealand was slightly slower.
